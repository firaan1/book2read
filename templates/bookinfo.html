{% extends "layout.html" %}

{% block title %}
Online Book Review
{% endblock %}

{% block body %}

<h1>Online Book Review</h1>

{{ session['logged_in'] }}
{{ book }}
{{ user_rating }}
{{ overall_rating }}

</br>
<div class="container">
		<h3>Book Info</h3>
		<ul class="list-group">
			<li>Title: <a href="/booksearch/{{ book[0] }}">{{ book[2] }}</a></li>
			<li>Author : <a href="/booksearch/{{ book[0] }}/author">{{ book[3] }}</a></li>
			<li>Year : <a href="/booksearch/{{ book[0] }}/year">Year : {{ book[4] }}</a></li>
			<li>ISBN : <a href="/booksearch/{{ book[0]}}">{{ book[1] }}</a></li>
		</ul>
</div>

<div class="container">

	<form action="{{ url_for('Book', book_id = book[0])}}" method="post">

		<h3>Rating</h3>

		<select class="form-group" name="user_rating">
			{% set counts = [1,2,3,4,5] %}
			<option value="{{i}}" selected disabled>Select your rating</option>
			{% for i in counts %}
				<option value="{{i}}">{{i}}</option>
			{% endfor %}
		</select>

		<h4>Your Rating: {% if user_rating %}{{ user_rating }}{% else %}-{% endif %} / 5</h4>

		<h4>Overall Rating: {% if overall_rating %}{{ overall_rating }}{% else %}-{% endif %} / 5</h4>

		<div class="form-group">
			<button name="buttonsrc" value="rate" class="btn btn-primary">Rate</button>
		</div>

		</br>

		<h3>Reviews</h3>
		{% if not user_review %}
		<div class="form-group">
			<h4>Share your review</h4>
			<textarea class="form-control" id="user_review" name="user_review" rows="3" cols="50"></textarea>
		</div>
		<div class="form-group">
			<button name="buttonsrc" value="review" class="btn btn-primary">Submit</button>
		</div>
		{% else %}
		<h4>Your Review: </h4>
		<p>{{ user_review }}</p>
		<div class="form-group">
			<button name="buttonsrc" value="deletereview" class="btn btn-primary">Delete</button>
		</div>
		{% endif %}
		</br>
		{% if overall_reviews %}
		<div class="table-wrapper-scroll-y scrolltable">
			<table class="table table-hover table-bordered">
				<thead>
					<tr>
						<th>User</th>
						<th>Review</th>
					</tr>
				</thead>
				<tbody>
					{% for review in overall_reviews %}
					<tr>
						<th>{{review[0]}}</th>
						<th>{{review[1]}}</th>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		{% endif %}
	</form>

</div>


</br>
<form action="{{ url_for('logout')}}">
	<div class="form-group">
		<button class="btn btn-primary">Logout</button>
	</div>
</form>

{% endblock %}
